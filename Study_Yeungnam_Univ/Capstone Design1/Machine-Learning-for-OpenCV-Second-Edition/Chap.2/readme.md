[Notion에서 Chap. 2 보기](https://cyber-podium-310.notion.site/2-OpenCV-d50fd306ad5f45d7bfbc9abe103f6756)

# 2장, OpenCV으로 데이터 작업

2장 에서는 몇가지 기본적인 OpenCV 기능을 살펴본다.



앞서 머신러닝은 인공지능의 하위 분야로 설명했음.

이러한 명제는 사실이지만, 대부분의 경우 머신러닝은 단순히 데이터를 이해하는 과정에 불과함.

그러므로 **머신러닝**을 **데이터 과학의 하위 분야**로 생각하는 것이 더 **적합**.

여기서는 데이터를 이해하는데 도움이 되는 **수학적 모델**을 구축해봄.

2장에서 다루는 내용은 아래와 같음.

- 일반적인 머신러닝 워크플로 이해
- 훈련 데이터와 테스트 데이터 이해
- OpenCV와 파이썬으로 데이터를 적재, 저장, 편집, 시각화하는 방법 학습

# 머신러닝 워크플로의 이해

앞서 언급했듯이, 머신러닝에서는 데이터를 이해하기 위한 수학 모델을 구축해야 함.

학습이라는 측면은 머신러닝 모델에서 내부 매개변수를 조정하는 과정임.

모델이 데이터를 더 잘 이해할 수 있도록 매개변수를 조정하는 것임.

이제 단계별로 생각해보자.

우선, 주의해야 할 점은 **머신러닝 문제**는 항상 (적어도) **두 개의 개별 단계**로 분리된다는 것이다.

- **훈련 단계**
    - 머신러닝 모델을 훈련시키고자 **훈련 데이터 세트**라고 불리는 일련의 데이터를 사용하는 **훈련 단계**가 **첫번째 단계.**
- **테스트 단계**
    - **테스트 데이터 세트**라고 부르는 이전에 본 적 없는 새로운 데이터 세트를 사용해 학습된 (또는 최종) 머신러닝 모델을 평가하는 **테스트 단계**가 **그 다음**이다.

고급 머신러닝 문제의 워크플로에는 일반적으로 **유효성 검사 데이터 세트(validation dataset)**라는 세 번째 데이터 세트가 포함된다. 현 시점에서는 이러한 구분이 중요하지 않지만, 유효성 검사 세트는 일반적으로 훈련 데이터 세트를 추가로 분할해 형성한다. 그리고 모델 선택과 같은 고급 개념에서 사용한다. 머신러닝 시스템 구축에 능숙해지면 11장에서 다룰 예정이다.

여기서 다음으로 주목해야 할 점은, 머신러닝은 데이터에 대한 모든 것을 다룬다는 것임.

데이터는 원시 형식으로 입력되고, 훈련 및 테스트 단계에서 사용됨.

원시 형식의 데이터는 픽셀, 문자, 단어 또는 비트 등등을 의미.

이러한 원시 형식의 데이터는 작업하기에 편리하지 않음,

따라서, 대신 데이터를 미리 구문 분석해서 데이터를 **파싱**하거나 사용하기 쉬운 형식으로 가져와야 하고, 이를 **데이터 전처리**라고 한다.

**데이터 전처리**는 아래와 같은 두 단계로 진행됨.

1. **특징 선택 (feature selection)**
    
    **데이터에서 중요한 속성(또는 기능)을 식별하는 프로세스**
    
    이미지에서의 주요 특징(feature)은 가장자리, 모서리, 또는 융기(ridge) 등등을 의미.
    
    SURF(Speeded Up Robust Feature) 또는 HOG(Histogram of Oriented Gradient)의 히스토그램처럼 OpenCV가 제공하는 고급 특징 기술자(advanced feature descriptor)에 익숙해져야함.
    
    이러한 기능은 모든 이미지에 적용할 수 있지만, 특정 작업에는 중요하지 않을 수도 있음.
    
    ex) 깨끗한 물과 더러운 물을 구별하는 것에서 가장 중요한 특징은 '물의 색'이라 SURF or HOG기능은 별로 도움이 안되지.
    

1. **특징 추출 (feature extraction)**
    
    **실제 데이터를 원하는 특징 공간으로 변환하는 프로세스**
    
    이미지의 모서리(즉, 선택된 특징)를 추출할 수 있는 해리스 연산자(Harris operator)가 예시임.
    

**특징 엔지니어링**(feature engineering)이라고 알고 있는 **정보 특징 생성 프로세스**(process of inventing informative features)는 고급 주제로 다뤄짐.

특징을 먼저 만들어줘야 좋은 특징을 선택&사용 할 수 있음.

**알고리즘을 선택하기 전**에 **먼저 특징을 만들어 놓는 것**이 알고리즘 사용에 있어 더 **중요**함.

4장에서 특징 엔지니어링을 자세히 다룰 것임.

특징 선택(feature selection)과 특징 추출(feature extraction)을 구분하기 어려울 수 있음. 예를 들어 **SURF**는 특징 추출기와 실제 특징 이름 모두를 나타냄. **SIFT**(Scale-Invariant Feature Transform)는 SIFT 특징으로 알려진 특징 검출기임. 불행하게도 두 알고리즘은 모두 특허를 받았고 상업적인 목적으로 사용될 수 없음. 이 책에서는 두 알고리즘에 대한 어떤 코드도 공유하지 않음.

마지막으로, 지도학습에서 사용하는 모든 데이터는 레이블이 있어야함.

특정 종류의 사물(ex. 개 or 고양이), 특정 가격(ex. 주택 가격)과 같은 레이블이 있어야 데이터를 식별 할 수 있음.

결국, 지도 머신러닝 시스템의 목표는 테스트 세트의 모든 데이터 포인트의 레이블을 예측하는 것임.

1. **훈련 데이터의 규칙성을 학습**하고
2. 함께 제공된 **레이블을 사용**하여
3. 테스트 세트에서 **성능을 테스트** 하는 것임.

따라서, 제대로 머신러닝 시스템을 구축 하려면,

먼저, 데이터를 적재, 저장, 조작 방법을 다뤄야한다.

아래부터 OpenCV에서 파이썬으로 이러한 작업들을 배울 것이다.

# OpenCV와 파이썬을 사용한 데이터 취급

다양한 종류의 데이터 유형이 있음.

그래서 특정 값에 사용할 데이터 유형을 구별하는 것이 어렵기도 함.

여기서는 표준 데이터 유형을 유지할 스칼라 값을 제외한 모든 것을 **배열로 처리**해 단순성을 유지할 것임.

**이미지**는 폭과 높이가 있기 때문에 **2D 배열**이 됨.

1**D 배열의 예시**로는 시간이 지남에 따라 강도가 변화하는 **사운드 클립**을 예로 들 수 있음.

OpenCV의 C++ API를 계속 사용하고 앞으로도 그렇게 할 계획이라면,,

C++에서 데이터를 처리하는 것이 다소 어려울 수 있음.

C++ 언어의 문법적 오버헤드를 처리해야 할 뿐만 아니라 다양한 데이터 유형과 플랫폼 간의 호환성 문제와 씨름 해야한다.

하지만, OpenCV 파이썬 API를 사용하면 SciPy(Scientific Python) 커뮤니티에서 제공하는 다수의 오픈소스 패키지에 자동으로 액세스 할 수 있기 때문에 프로세스가 대폭 간소화 됨.

많은 과학 연산 도구를 제공하는 NumPy(Numerical Python) 패키지가 그 중 하나임.

## 파이썬 NumPy 패키지를 사용한 데이터 취급

아나콘다를 설치했다면 이미 NumPy도 설치 되어있음.

NumPy에 익숙해지면 파이썬 세계에서 가장 과학적인 컴퓨팅 도구를 주변에 구축한 것임.

여기에는 OpenCV가 포함돼 있으므로, NumPy 학습에 소요되는 시간에서 결국 이득..

NumPy를 시작하는 방법을 간략히 설명할 건데,

고급 수준의 파이썬 사용자라면 이 절을 건너뛰어도 무방..!

### NumPy 가져오기

![Untitled](https://user-images.githubusercontent.com/87224039/139394059-9a990512-8ee1-46fe-9792-d67d972181d7.png)



일반적으로 과학적인 용도로 파이썬을 사용할 때, np를 별칭으로 NumPy를 가져온다.

### NumPy 배열의 이해

![Untitled 1](https://user-images.githubusercontent.com/87224039/139394066-21cf370c-d9a5-47d3-ba3d-a6f902dbf1d1.png)



파이썬은 type에 유연한 언어임.

즉, 새 변수를 만들 때마다 데이터 유형을 지정할 필요가 없음.

착하게 정수라고 자동 지정되네

표준 **파이썬** 구현은 **C로 작성**됬기 때문에 **모든 파이썬 객체는** **C 구조가** 기본적으로 **들어가 있다**. 이는 파이썬의 정수도 마찬가지다. 실제로는 원시 정수 값 이상을 포함하는 복합 C 구조의 포인터다. 따라서 파이썬 정수를 나타내는 데 사용되는 기본 C 데이터 유형은 시스템 아키텍처(즉 32비트 또는 64비트 플랫폼)에 따라 달라진다.

파이썬에서 표준 다중 요소 컨테이너인 `list()` 명령을 사용해 정수 리스트를 만들 수 있다.

`range(x)` 함수는 0부터 x-1까지의 모든 정수를 나타내며, 생성한다.

변수를 출력하려면 `print` 함수를 사용하거나 변수 이름을 입력하고 **Enter**를 누른다.

![Untitled 2](https://user-images.githubusercontent.com/87224039/139394074-d50b2412-e69a-4233-97e5-e57484cde2b8.png)


파이썬에서 정수 리스트 `int_list`의 모든 요소를 반복하고 각 요소에 `str()` 함수(숫자를 문자열로 변환하는 함수)를 적용해 **문자열 리스트**를 만들 수 있다.

![Untitled 3](https://user-images.githubusercontent.com/87224039/139394089-a241f118-9ce6-49b5-8cb0-d108154a9a6e.png)


### 인덱싱을 통해 단일 배열 요소에 액세스

### 다차원 배열 만들기

### 파이썬에서 외부 데이터 세트 불러오기

### Matplotlib을 사용한 데이터 시각화

# C++에서 OpenCV의 TrainData 컨테이너를 사용해 데이터 다루기

# 요약
